<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Edit Profile | Pixels Dojo</title>
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <%- include('partials/header') %>

  <div class="container">
    <h1>Edit Profile</h1>

    <% if (locals.error) { %>
      <p class="error"><%= error %></p>
    <% } %>

    <form action="/profile/edit" method="POST" enctype="multipart/form-data">
      <!-- Avatar - everyone -->
      <div class="form-group">
        <label for="profile_image">Profile Picture</label>
        <input type="file" id="profile_image" name="profile_image" accept="image/*">
        <img src="<%= user.profile_image %>" alt="Current" style="max-width:120px; border-radius:50%; margin-top:0.5rem;">
      </div>

      <!-- Display Name - contributors only -->
      <div class="form-group">
        <label for="display_name">Display Name</label>
        <input type="text" id="display_name" name="display_name" 
               value="<%= user.display_name || user.username %>" 
               <%= user.is_contributor ? '' : 'disabled' %>>
        <% if (!user.is_contributor) { %>
          <small>(Only contributors can set this)</small>
        <% } %>
      </div>

      <!-- Bio - contributors only -->
      <div class="form-group">
        <label for="bio">Bio / About</label>
        <textarea id="bio" name="bio" rows="4" 
                  <%= user.is_contributor ? '' : 'disabled' %>><%= user.bio || '' %></textarea>
        <% if (!user.is_contributor) { %>
          <small>(Contributors only)</small>
        <% } %>
      </div>

      <!-- Social Links - contributors only -->
      <div class="form-group">
        <label for="social_links">Social Links (one per line: Platform | URL)</label>
        <textarea id="social_links" name="social_links" rows="4" 
                  <%= user.is_contributor ? '' : 'disabled' %>>
<%= user.social_links ? user.social_links.split(',').join('\n') : '' %>
        </textarea>
        <% if (!user.is_contributor) { %>
          <small>(Contributors only)</small>
        <% } %>
      </div>

      <!-- Tip Address - contributors only -->
      <div class="form-group">
        <label for="tip_address">Tip Address (PayPal, wallet, etc.)</label>
        <input type="text" id="tip_address" name="tip_address" 
               value="<%= user.tip_address || '' %>" 
               <%= user.is_contributor ? '' : 'disabled' %>>
        <% if (!user.is_contributor) { %>
          <small>(Contributors only)</small>
        <% } %>
      </div>

      <button type="submit" class="btn">Save Changes</button>
    </form>
  </div>

  <%- include('partials/footer') %>
</body>
</html>
